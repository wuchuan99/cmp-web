<template>
  <div class="vulnerability-validation">
    <div class="main">
      <new-table
        ref="newTable"
        :border="true"
        :columns="table.columns"
        :data="records"
        :loading="loading"
      />
    </div>
    <check ref="check" @update="update" />
  </div>
</template>
<script>
import { debounce } from "@/utils/common";
import check from "./components/check.vue";
export default {
  components: { check },
  data() {
    return {
      loading: false,
      records: [
        {
          id: 1,
          name: "xxxxx",
          level: "超危",
          assets: 2
        }
      ],
      table: {
        columns: [
          { type: "index", label: "序号", width: 80 },
          { prop: "name", label: "名称" },
          { prop: "level", label: "风险等级" },
          {
            prop: "assets",
            label: "风险资产",
            render: scope => {
              return (
                <span
                  style="text-decoration: underline;color: #135BD2;cursor: pointer;"
                  onclick={() =>
                    this.handle({
                      action: "check",
                      type: "view",
                      data: scope.row
                    })
                  }
                >
                  {scope.row.assets}
                </span>
              );
            }
          },
          {
            label: "操作",
            width: "140",
            showOverflowTooltip: false,
            render: scope => {
              return (
                <div class="cell-operation">
                  <span
                    class="primary"
                    onclick={() =>
                      this.handle({
                        action: "check",
                        type: "edit",
                        data: scope.row
                      })
                    }
                  >
                    验证
                  </span>
                </div>
              );
            }
          }
        ]
      }
    };
  },
  created() {},
  mounted() {},
  methods: {
    handle: debounce(function(context) {
      this[context.action] && this[context.action](context);
    }, 200),
    check({ action, type, data }) {
      this.$refs[action].show({ type, row: data });
    },
    update(data) {
      console.log(data);
    }
  }
};
</script>
<style lang="scss" scoped>
.vulnerability-validation {
  height: 100%;
  padding: 25px 0;
  .main {
    padding: 20px;
    height: 100%;
    background-color: white;
    box-shadow: 0px 2px 7px 0px rgba(0, 0, 0, 0.17);
  }
}
</style>
